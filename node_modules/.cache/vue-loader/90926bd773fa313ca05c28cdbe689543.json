{"remainingRequest":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\src\\views\\Home.vue","mtime":1604995505949},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHlhbmRleE1hcCwgbG9hZFltYXAsIHltYXBNYXJrZXIgfSBmcm9tICd2dWUteWFuZGV4LW1hcHMnOwppbXBvcnQgeyBkZWJvdW5jZSwgc29ydEJ5IH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IG1rYWRBcnJheSBmcm9tICcuL21rYWQnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgeWFuZGV4TWFwLCB5bWFwTWFya2VyIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9wdDogMC40LAogICAgICBjb29yZHM6IFtdLAogICAgICBhZGRyZXNzOiBudWxsLAogICAgICBwb2x5Z29uOiBta2FkQXJyYXksCiAgICAgIGdsb2JhbE1hcDogbnVsbCwKICAgICAgcm91dGU6IG51bGwsCiAgICAgIGFpclJvdXRlOiBudWxsLAogICAgICB6b29tOiAxMiwKICAgICAgcG9pbnRzOiA1LAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlYm91bmNlLAogICAgYXN5bmMgb25DbGljayhlKSB7CiAgICAgIHRoaXMuY29vcmRzID0gZS5nZXQoJ2Nvb3JkcycpOwogICAgICB0aGlzLmdldEFkcmVzcygpOwogICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgY29uc3QgY2xvc2VzdERpc3RhbmNlID0gYXdhaXQgdGhpcy7RgWFsY0Nsb3Nlc3REaXN0YW5jZShlKTsKICAgICAgdGhpcy5zZXRSb3V0ZShlLCBjbG9zZXN0RGlzdGFuY2UpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICAvKiDRgdC+0YXRgNCw0L3QtdC90LjQtSDQutCw0YDRgtGLINCyINC/0LXRgNC10LzQtdC90L3Rg9GOICovCiAgICBpbml0TWFwKG1hcCkgewogICAgICB0aGlzLmdsb2JhbE1hcCA9IG1hcDsKICAgIH0sCiAgICAvKiAtICovCiAgICBhc3luYyBnZW9jb2RlcigpIHsKICAgICAgYXdhaXQgbG9hZFltYXAoKTsKICAgIH0sCiAgICAvKiDQv9C+0LvRg9GH0LXQvdC40LUg0LDQtNGA0LXRgdCwINC/0L4g0LrQvtC+0YDQtNC40L3QsNGC0LDQvCAqLwogICAgYXN5bmMgZ2V0QWRyZXNzKCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgeW1hcHMuZ2VvY29kZSh0aGlzLmNvb3JkcykKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmFkZHJlc3MgPSByZXMuZ2VvT2JqZWN0cy5nZXQoMCkKICAgICAgICAgICAgLmdldEFkZHJlc3NMaW5lKCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgLyog0YDQsNGB0YfQtdGCINCx0LvQuNC20LDQudGI0LXQs9C+INGA0LDRgdGB0YLQvtGP0L3QuNGPINC/0L4g0LLQvtC30LTRg9GF0YMgKi8KICAgINGBYWxjQ2xvc2VzdERpc3RhbmNlKGUpIHsKICAgICAgY29uc3QgY3VycmVudFBvaW50ID0gZS5nZXQoJ2Nvb3JkcycpOwogICAgICBjb25zdCBvYmplY3QgPSBbXTsKICAgICAgdGhpcy5wb2x5Z29uLmZvckVhY2goYXN5bmMgKGNvb3JkcykgPT4gewogICAgICAgIGNvbnN0IHIgPSA2MzcxOyAvLyDQoNCw0LTQuNGD0YEg0LfQtdC80LvQuAogICAgICAgIGNvbnN0IGRMYXQgPSAoY3VycmVudFBvaW50WzBdLnRvRml4ZWQoNikgLSBjb29yZHNbMF0pICogKE1hdGguUEkgLyAxODApOwogICAgICAgIGNvbnN0IGRMb24gPSAoY3VycmVudFBvaW50WzFdLnRvRml4ZWQoNikgLSBjb29yZHNbMV0pICogKE1hdGguUEkgLyAxODApOwogICAgICAgIGNvbnN0IGEgPSBNYXRoLnNpbihkTGF0IC8gMikgKiBNYXRoLnNpbihkTGF0IC8gMikKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxlbgogICAgICAgICAgICAgICAgICArIE1hdGguY29zKGNvb3Jkc1swXSAqIChNYXRoLlBJIC8gMTgwKSkgKiBNYXRoLmNvcyhjdXJyZW50UG9pbnRbMF0gKiAoTWF0aC5QSSAvIDE4MCkpCiAgICAgICAgICAgICAgICAgICogTWF0aC5zaW4oZExvbiAvIDIpICogTWF0aC5zaW4oZExvbiAvIDIpOwogICAgICAgIGNvbnN0IGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxIC0gYSkpOwogICAgICAgIGNvbnN0IGRpc3RhbmNlID0gciAqIGM7CiAgICAgICAgb2JqZWN0LnB1c2goeyBkaXN0YW5jZSwgY29vcmRzIH0pOwogICAgICB9KTsKICAgICAgcmV0dXJuIG9iamVjdDsKICAgIH0sCiAgICAvKiDRgNCw0YHRh9C10YIg0LHQu9C40LbQsNC50YjQtdCz0L4g0YDQsNGB0YHRgtC+0Y/QvdC40Y8g0L/QviDQt9C10LzQu9C1ICovCiAgICBhc3luYyBjYWxjRGlzdGFuY2UoZSwgY29vcmRzKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgICBjb25zdCBkaXMgPSBhd2FpdCB5bWFwcy5yb3V0ZShbZS5nZXQoJ2Nvb3JkcycpLCBjb29yZHNdKTsKICAgICAgcmV0dXJuIGRpcy5nZXRMZW5ndGgoKTsKICAgIH0sCiAgICBzZXRSb3V0ZShlLCBkaXN0YW5jZXMpIHsKICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBzb3J0QnkoZGlzdGFuY2VzLCAnZGlzdGFuY2UnKTsKICAgICAgY29uc3QgY291bnQgPSB0aGlzLnBvaW50czsKICAgICAgdGhpcy5nZXREaXN0UHJvY2Nlc3Moc2VsZWN0ZWQuc2xpY2UoMCwgY291bnQpLCBlKTsKICAgIH0sCiAgICBhc3luYyBnZXREaXN0UHJvY2Nlc3Moc2VsZWN0ZWQsIGUpIHsKICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTsKICAgICAgc2VsZWN0ZWQuZm9yRWFjaCgocG9pbnQpID0+IHsKICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuY2FsY0Rpc3RhbmNlKGUsIHBvaW50LmNvb3JkcykpOwogICAgICB9KTsKICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oKHJlcykgPT4gewogICAgICAgIGxldCBtaW4gPSAwOwogICAgICAgIGxldCBtaW5SZXMgPSByZXNbMF07CiAgICAgICAgcmVzLmZvckVhY2goKHBvaW50LCBpbmRleCkgPT4gewogICAgICAgICAgaWYgKHBvaW50IDwgbWluUmVzKSB7CiAgICAgICAgICAgIG1pblJlcyA9IHBvaW50OwogICAgICAgICAgICBtaW4gPSBpbmRleDsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygn0KDQsNGB0YHRgtC+0Y/QvdC40LUg0L/QviDQstC+0LfQtNGD0YXRgzogICcsIHNlbGVjdGVkWzBdKTsKICAgICAgICBjb25zb2xlLmxvZygn0KDQsNGB0YHRgtC+0Y/QvdC40LUg0L/QviDQtNC+0YDQvtCz0LDQvDogICcsIHNlbGVjdGVkW21pbl0pOwogICAgICAgIHRoaXMucm91dGVDYXJEaXN0YW5jZShlLCBzZWxlY3RlZFttaW5dKTsKICAgICAgICB0aGlzLnJvdXRlQWlyRGlzdGFuY2UoZSwgc2VsZWN0ZWRbMF0pOwogICAgICB9KTsKICAgIH0sCiAgICByb3V0ZUNhckRpc3RhbmNlKGUsIHNlbGVjdCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgeW1hcHMucm91dGUoW2UuZ2V0KCdjb29yZHMnKSwgc2VsZWN0LmNvb3Jkc10pLnRoZW4oKHJvdXRlcikgPT4gewogICAgICAgIGlmICh0aGlzLnJvdXRlKSB0aGlzLmdsb2JhbE1hcC5nZW9PYmplY3RzLnJlbW92ZSh0aGlzLnJvdXRlKTsKICAgICAgICB0aGlzLnJvdXRlID0gcm91dGVyLmdldFBhdGhzKCk7CiAgICAgICAgdGhpcy5yb3V0ZS5vcHRpb25zLnNldCh7IHN0cm9rZVdpZHRoOiA1LCBzdHJva2VDb2xvcjogJzIyN2YwNScsIG9wYWNpdHk6IDAuNyB9KTsKICAgICAgICB0aGlzLmdsb2JhbE1hcC5nZW9PYmplY3RzLmFkZCh0aGlzLnJvdXRlKTsKICAgICAgfSk7CiAgICB9LAogICAgcm91dGVBaXJEaXN0YW5jZShlLCBzZWxlY3QpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmCiAgICAgIGNvbnN0IG15R2VvT2JqZWN0ID0gbmV3IHltYXBzLkdlb09iamVjdCh7CiAgICAgICAgZ2VvbWV0cnk6IHsKICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKICAgICAgICAgIGNvb3JkaW5hdGVzOiBbZS5nZXQoJ2Nvb3JkcycpLCBzZWxlY3QuY29vcmRzXSwKICAgICAgICB9LAogICAgICB9LCB7CiAgICAgICAgc3Ryb2tlQ29sb3I6ICcjMDAwMDAwJywKICAgICAgICBzdHJva2VXaWR0aDogNCwKICAgICAgICBzdHJva2VTdHlsZTogJzEgNScsCiAgICAgIH0pOwogICAgICBpZiAodGhpcy5haXJSb3V0ZSkgdGhpcy5nbG9iYWxNYXAuZ2VvT2JqZWN0cy5yZW1vdmUodGhpcy5haXJSb3V0ZSk7CiAgICAgIHRoaXMuYWlyUm91dGUgPSBteUdlb09iamVjdDsKICAgICAgdGhpcy5nbG9iYWxNYXAuZ2VvT2JqZWN0cy5hZGQodGhpcy5haXJSb3V0ZSk7CiAgICB9LAogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIGF3YWl0IGxvYWRZbWFwKCk7CiAgfSwKfTsK"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <yandex-map\n            :zoom=\"zoom\"\n            style=\"width: 100%; max-width: 100%; height: 98vh;\"\n            :coords= \"coords.length ? coords : [55.7521833, 37.613614]\"\n            @click=\"onClick\"\n            @map-was-initialized=\"initMap\"\n    >\n      <ymap-marker\n              :coords=\"coords\"\n              marker-id=\"123\"\n              hint-content=\"some hint\"\n      />\n      <ymap-marker\n              :marker-id=\"1234\"\n              marker-type=\"polygon\"\n              :coords=\"[polygon,[]]\"\n              circle-radius=\"16000\"\n              :marker-fill=\"{color: '#1890ff', opacity: opt}\"\n              :marker-stroke=\"{color: '#1890ff', width: 1}\"\n              @click=\"onClick\"\n      ></ymap-marker>\n    </yandex-map>\n  </div>\n</template>\n\n<script>\nimport { yandexMap, loadYmap, ymapMarker } from 'vue-yandex-maps';\nimport { debounce, sortBy } from 'lodash';\nimport mkadArray from './mkad';\n\nexport default {\n  components: { yandexMap, ymapMarker },\n  data() {\n    return {\n      opt: 0.4,\n      coords: [],\n      address: null,\n      polygon: mkadArray,\n      globalMap: null,\n      route: null,\n      airRoute: null,\n      zoom: 12,\n      points: 5,\n    };\n  },\n  methods: {\n    debounce,\n    async onClick(e) {\n      this.coords = e.get('coords');\n      this.getAdress();\n      console.log(e);\n      const closestDistance = await this.сalcClosestDistance(e);\n      this.setRoute(e, closestDistance);\n      return true;\n    },\n    /* сохранение карты в переменную */\n    initMap(map) {\n      this.globalMap = map;\n    },\n    /* - */\n    async geocoder() {\n      await loadYmap();\n    },\n    /* получение адреса по координатам */\n    async getAdress() {\n      // eslint-disable-next-line no-undef\n      ymaps.geocode(this.coords)\n        .then((res) => {\n          this.address = res.geoObjects.get(0)\n            .getAddressLine();\n        });\n    },\n    /* расчет ближайшего расстояния по воздуху */\n    сalcClosestDistance(e) {\n      const currentPoint = e.get('coords');\n      const object = [];\n      this.polygon.forEach(async (coords) => {\n        const r = 6371; // Радиус земли\n        const dLat = (currentPoint[0].toFixed(6) - coords[0]) * (Math.PI / 180);\n        const dLon = (currentPoint[1].toFixed(6) - coords[1]) * (Math.PI / 180);\n        const a = Math.sin(dLat / 2) * Math.sin(dLat / 2)\n        // eslint-disable-next-line max-len\n                  + Math.cos(coords[0] * (Math.PI / 180)) * Math.cos(currentPoint[0] * (Math.PI / 180))\n                  * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n        const distance = r * c;\n        object.push({ distance, coords });\n      });\n      return object;\n    },\n    /* расчет ближайшего расстояния по земле */\n    async calcDistance(e, coords) {\n      // eslint-disable-next-line no-undef\n      const dis = await ymaps.route([e.get('coords'), coords]);\n      return dis.getLength();\n    },\n    setRoute(e, distances) {\n      const selected = sortBy(distances, 'distance');\n      const count = this.points;\n      this.getDistProccess(selected.slice(0, count), e);\n    },\n    async getDistProccess(selected, e) {\n      const promises = [];\n      selected.forEach((point) => {\n        promises.push(this.calcDistance(e, point.coords));\n      });\n      await Promise.all(promises).then((res) => {\n        let min = 0;\n        let minRes = res[0];\n        res.forEach((point, index) => {\n          if (point < minRes) {\n            minRes = point;\n            min = index;\n          }\n        });\n        console.log('Расстояние по воздуху:  ', selected[0]);\n        console.log('Расстояние по дорогам:  ', selected[min]);\n        this.routeCarDistance(e, selected[min]);\n        this.routeAirDistance(e, selected[0]);\n      });\n    },\n    routeCarDistance(e, select) {\n      // eslint-disable-next-line no-undef\n      ymaps.route([e.get('coords'), select.coords]).then((router) => {\n        if (this.route) this.globalMap.geoObjects.remove(this.route);\n        this.route = router.getPaths();\n        this.route.options.set({ strokeWidth: 5, strokeColor: '227f05', opacity: 0.7 });\n        this.globalMap.geoObjects.add(this.route);\n      });\n    },\n    routeAirDistance(e, select) {\n      // eslint-disable-next-line no-undef\n      const myGeoObject = new ymaps.GeoObject({\n        geometry: {\n          type: 'LineString',\n          coordinates: [e.get('coords'), select.coords],\n        },\n      }, {\n        strokeColor: '#000000',\n        strokeWidth: 4,\n        strokeStyle: '1 5',\n      });\n      if (this.airRoute) this.globalMap.geoObjects.remove(this.airRoute);\n      this.airRoute = myGeoObject;\n      this.globalMap.geoObjects.add(this.airRoute);\n    },\n  },\n  async mounted() {\n    await loadYmap();\n  },\n};\n</script>\n\n<style scoped>\n</style>\n"]}]}