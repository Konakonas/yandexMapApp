{"remainingRequest":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\src\\views\\Home.vue","mtime":1604957365883},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Тагир\\Desktop\\project\\tableProject\\yandexMapApp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHlhbmRleE1hcCwgbG9hZFltYXAsIHltYXBNYXJrZXIgfSBmcm9tICd2dWUteWFuZGV4LW1hcHMnOwppbXBvcnQgeyBkZWJvdW5jZSwgc29ydEJ5IH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IG1rYWRBcnJheSBmcm9tICcuL21rYWQnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgeWFuZGV4TWFwLCB5bWFwTWFya2VyIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9wdDogMC40LAogICAgICBjb29yZHM6IFtdLAogICAgICBhZGRyZXNzOiBudWxsLAogICAgICBwb2x5Z29uOiBta2FkQXJyYXksCiAgICAgIGdsb2JhbE1hcDogbnVsbCwKICAgICAgcm91dGU6IG51bGwsCiAgICAgIGFpclJvdXRlOiBudWxsLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlYm91bmNlLAogICAgYXN5bmMgb25DbGljayhlKSB7CiAgICAgIHRoaXMuY29vcmRzID0gZS5nZXQoJ2Nvb3JkcycpOwogICAgICBjb25zdCBjbG9zZXN0RGlzdGFuY2UgPSBhd2FpdCB0aGlzLmdldENsb3Nlc3REaXN0YW5jZShlKTsKICAgICAgdGhpcy5zZXRSb3V0ZShlLCBjbG9zZXN0RGlzdGFuY2UpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICAvKiAtICovCiAgICBpbml0TWFwKG1hcCkgewogICAgICB0aGlzLmdsb2JhbE1hcCA9IG1hcDsKICAgIH0sCiAgICAvKiAtICovCiAgICBhc3luYyBnZW9jb2RlcigpIHsKICAgICAgYXdhaXQgbG9hZFltYXAoKTsKICAgIH0sCiAgICAvKiAtICovCiAgICBhc3luYyBnZXRBZHJlc3MoKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgICB5bWFwcy5nZW9jb2RlKHRoaXMuY29vcmRzKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuYWRkcmVzcyA9IHJlcy5nZW9PYmplY3RzLmdldCh0aGlzLnJvdXRlKQogICAgICAgICAgICAuZ2V0QWRkcmVzc0xpbmUoKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvKiAtICovCiAgICBnZXRDbG9zZXN0RGlzdGFuY2UoZSkgewogICAgICBjb25zdCBjdXJyZW50UG9pbnQgPSBlLmdldCgnY29vcmRzJyk7CiAgICAgIGNvbnN0IG9iamVjdCA9IFtdOwogICAgICB0aGlzLnBvbHlnb24uZm9yRWFjaChhc3luYyAoY29vcmRzKSA9PiB7CiAgICAgICAgY29uc3QgciA9IDYzNzE7IC8vINCg0LDQtNC40YPRgSDQt9C10LzQu9C4CiAgICAgICAgY29uc3QgZExhdCA9IChjdXJyZW50UG9pbnRbMF0udG9GaXhlZCg2KSAtIGNvb3Jkc1swXSkgKiAoTWF0aC5QSSAvIDE4MCk7CiAgICAgICAgY29uc3QgZExvbiA9IChjdXJyZW50UG9pbnRbMV0udG9GaXhlZCg2KSAtIGNvb3Jkc1sxXSkgKiAoTWF0aC5QSSAvIDE4MCk7CiAgICAgICAgY29uc3QgYSA9IE1hdGguc2luKGRMYXQgLyAyKSAqIE1hdGguc2luKGRMYXQgLyAyKQogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuCiAgICAgICAgICAgICAgICAgICsgTWF0aC5jb3MoY29vcmRzWzBdICogKE1hdGguUEkgLyAxODApKSAqIE1hdGguY29zKGN1cnJlbnRQb2ludFswXSAqIChNYXRoLlBJIC8gMTgwKSkKICAgICAgICAgICAgICAgICAgKiBNYXRoLnNpbihkTG9uIC8gMikgKiBNYXRoLnNpbihkTG9uIC8gMik7CiAgICAgICAgY29uc3QgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEgLSBhKSk7CiAgICAgICAgY29uc3QgZGlzdGFuY2UgPSByICogYzsKICAgICAgICBvYmplY3QucHVzaCh7IGRpc3RhbmNlLCBjb29yZHMgfSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gb2JqZWN0OwogICAgfSwKICAgIGFzeW5jIGdldERpc3RhbmNlKGUsIGNvb3JkcykgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgY29uc3QgZGlzID0gYXdhaXQgeW1hcHMucm91dGUoW2UuZ2V0KCdjb29yZHMnKSwgY29vcmRzXSk7CiAgICAgIHJldHVybiBkaXMuZ2V0TGVuZ3RoKCk7CiAgICB9LAogICAgc2V0Um91dGUoZSwgZGlzdGFuY2VzKSB7CiAgICAgIGNvbnN0IHNlbGVjdGVkID0gc29ydEJ5KGRpc3RhbmNlcywgJ2Rpc3RhbmNlJyk7CiAgICAgIGNvbnN0IGNvdW50ID0gNTsKICAgICAgdGhpcy5nZXREaXN0UHJvY2Nlc3Moc2VsZWN0ZWQuc2xpY2UoMCwgY291bnQpLCBlKTsKICAgIH0sCiAgICBhc3luYyBnZXREaXN0UHJvY2Nlc3Moc2VsZWN0ZWQsIGUpIHsKICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTsKICAgICAgc2VsZWN0ZWQuZm9yRWFjaCgocG9pbnQpID0+IHsKICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuZ2V0RGlzdGFuY2UoZSwgcG9pbnQuY29vcmRzKSk7CiAgICAgIH0pOwogICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbigocmVzKSA9PiB7CiAgICAgICAgbGV0IG1pbiA9IDA7CiAgICAgICAgbGV0IG1pblJlcyA9IHJlc1swXTsKICAgICAgICByZXMuZm9yRWFjaCgocG9pbnQsIGluZGV4KSA9PiB7CiAgICAgICAgICBpZiAocG9pbnQgPCBtaW5SZXMpIHsKICAgICAgICAgICAgbWluUmVzID0gcG9pbnQ7CiAgICAgICAgICAgIG1pbiA9IGluZGV4OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCfQoNCw0YHRgdGC0L7Rj9C90LjQtSDQv9C+INCy0L7Qt9C00YPRhdGDOiAgJywgc2VsZWN0ZWRbMF0pOwogICAgICAgIGNvbnNvbGUubG9nKCfQoNCw0YHRgdGC0L7Rj9C90LjQtSDQv9C+INC00L7RgNC+0LPQsNC8OiAgJywgc2VsZWN0ZWRbbWluXSk7CiAgICAgICAgdGhpcy5yb3V0ZUNhckRpc3RhbmNlKGUsIHNlbGVjdGVkW21pbl0pOwogICAgICAgIHRoaXMucm91dGVBaXJEaXN0YW5jZShlLCBzZWxlY3RlZFswXSk7CiAgICAgIH0pOwogICAgfSwKICAgIHJvdXRlQ2FyRGlzdGFuY2UoZSwgc2VsZWN0KSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgICB5bWFwcy5yb3V0ZShbZS5nZXQoJ2Nvb3JkcycpLCBzZWxlY3QuY29vcmRzXSkudGhlbigocm91dGVyKSA9PiB7CiAgICAgICAgaWYgKHRoaXMucm91dGUpIHRoaXMuZ2xvYmFsTWFwLmdlb09iamVjdHMucmVtb3ZlKHRoaXMucm91dGUpOwogICAgICAgIHRoaXMucm91dGUgPSByb3V0ZXIuZ2V0UGF0aHMoKTsKICAgICAgICB0aGlzLnJvdXRlLm9wdGlvbnMuc2V0KHsgc3Ryb2tlV2lkdGg6IDUsIHN0cm9rZUNvbG9yOiAnMjI3ZjA1Jywgb3BhY2l0eTogMC43IH0pOwogICAgICAgIHRoaXMuZ2xvYmFsTWFwLmdlb09iamVjdHMuYWRkKHRoaXMucm91dGUpOwogICAgICB9KTsKICAgIH0sCiAgICByb3V0ZUFpckRpc3RhbmNlKGUsIHNlbGVjdCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgY29uc3QgbXlHZW9PYmplY3QgPSBuZXcgeW1hcHMuR2VvT2JqZWN0KHsKICAgICAgICBnZW9tZXRyeTogewogICAgICAgICAgdHlwZTogJ0xpbmVTdHJpbmcnLAogICAgICAgICAgY29vcmRpbmF0ZXM6IFtlLmdldCgnY29vcmRzJyksIHNlbGVjdC5jb29yZHNdLAogICAgICAgIH0sCiAgICAgIH0sIHsKICAgICAgICBzdHJva2VDb2xvcjogJyMwMDAwMDAnLAogICAgICAgIHN0cm9rZVdpZHRoOiA0LAogICAgICAgIHN0cm9rZVN0eWxlOiAnMSA1JywKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLmFpclJvdXRlKSB0aGlzLmdsb2JhbE1hcC5nZW9PYmplY3RzLnJlbW92ZSh0aGlzLmFpclJvdXRlKTsKICAgICAgdGhpcy5haXJSb3V0ZSA9IG15R2VvT2JqZWN0OwogICAgICB0aGlzLmdsb2JhbE1hcC5nZW9PYmplY3RzLmFkZCh0aGlzLmFpclJvdXRlKTsKICAgIH0sCiAgfSwKICBhc3luYyBtb3VudGVkKCkgewogICAgYXdhaXQgbG9hZFltYXAoKTsKICB9LAp9Owo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <yandex-map\n            zoom=\"12\"\n            style=\"width: 100%; max-width: 100%; height: 98vh;\"\n            :coords= \"coords.length ? coords : [55.7521833, 37.613614]\"\n            @click=\"onClick\"\n            @map-was-initialized=\"initMap\"\n    >\n      <ymap-marker\n              :coords=\"coords\"\n              marker-id=\"123\"\n              hint-content=\"some hint\"\n      />\n      <ymap-marker\n              :marker-id=\"1234\"\n              marker-type=\"polygon\"\n              :coords=\"[polygon,[]]\"\n              circle-radius=\"16000\"\n              :marker-fill=\"{color: '#1890ff', opacity: opt}\"\n              :marker-stroke=\"{color: '#1890ff', width: 1}\"\n      ></ymap-marker>\n    </yandex-map>\n  </div>\n</template>\n\n<script>\nimport { yandexMap, loadYmap, ymapMarker } from 'vue-yandex-maps';\nimport { debounce, sortBy } from 'lodash';\nimport mkadArray from './mkad';\n\nexport default {\n  components: { yandexMap, ymapMarker },\n  data() {\n    return {\n      opt: 0.4,\n      coords: [],\n      address: null,\n      polygon: mkadArray,\n      globalMap: null,\n      route: null,\n      airRoute: null,\n    };\n  },\n  methods: {\n    debounce,\n    async onClick(e) {\n      this.coords = e.get('coords');\n      const closestDistance = await this.getClosestDistance(e);\n      this.setRoute(e, closestDistance);\n      return true;\n    },\n    /* - */\n    initMap(map) {\n      this.globalMap = map;\n    },\n    /* - */\n    async geocoder() {\n      await loadYmap();\n    },\n    /* - */\n    async getAdress() {\n      // eslint-disable-next-line no-undef\n      ymaps.geocode(this.coords)\n        .then((res) => {\n          this.address = res.geoObjects.get(this.route)\n            .getAddressLine();\n        });\n    },\n    /* - */\n    getClosestDistance(e) {\n      const currentPoint = e.get('coords');\n      const object = [];\n      this.polygon.forEach(async (coords) => {\n        const r = 6371; // Радиус земли\n        const dLat = (currentPoint[0].toFixed(6) - coords[0]) * (Math.PI / 180);\n        const dLon = (currentPoint[1].toFixed(6) - coords[1]) * (Math.PI / 180);\n        const a = Math.sin(dLat / 2) * Math.sin(dLat / 2)\n        // eslint-disable-next-line max-len\n                  + Math.cos(coords[0] * (Math.PI / 180)) * Math.cos(currentPoint[0] * (Math.PI / 180))\n                  * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n        const distance = r * c;\n        object.push({ distance, coords });\n      });\n      return object;\n    },\n    async getDistance(e, coords) {\n      // eslint-disable-next-line no-undef\n      const dis = await ymaps.route([e.get('coords'), coords]);\n      return dis.getLength();\n    },\n    setRoute(e, distances) {\n      const selected = sortBy(distances, 'distance');\n      const count = 5;\n      this.getDistProccess(selected.slice(0, count), e);\n    },\n    async getDistProccess(selected, e) {\n      const promises = [];\n      selected.forEach((point) => {\n        promises.push(this.getDistance(e, point.coords));\n      });\n      await Promise.all(promises).then((res) => {\n        let min = 0;\n        let minRes = res[0];\n        res.forEach((point, index) => {\n          if (point < minRes) {\n            minRes = point;\n            min = index;\n          }\n        });\n        console.log('Расстояние по воздуху:  ', selected[0]);\n        console.log('Расстояние по дорогам:  ', selected[min]);\n        this.routeCarDistance(e, selected[min]);\n        this.routeAirDistance(e, selected[0]);\n      });\n    },\n    routeCarDistance(e, select) {\n      // eslint-disable-next-line no-undef\n      ymaps.route([e.get('coords'), select.coords]).then((router) => {\n        if (this.route) this.globalMap.geoObjects.remove(this.route);\n        this.route = router.getPaths();\n        this.route.options.set({ strokeWidth: 5, strokeColor: '227f05', opacity: 0.7 });\n        this.globalMap.geoObjects.add(this.route);\n      });\n    },\n    routeAirDistance(e, select) {\n      // eslint-disable-next-line no-undef\n      const myGeoObject = new ymaps.GeoObject({\n        geometry: {\n          type: 'LineString',\n          coordinates: [e.get('coords'), select.coords],\n        },\n      }, {\n        strokeColor: '#000000',\n        strokeWidth: 4,\n        strokeStyle: '1 5',\n      });\n      if (this.airRoute) this.globalMap.geoObjects.remove(this.airRoute);\n      this.airRoute = myGeoObject;\n      this.globalMap.geoObjects.add(this.airRoute);\n    },\n  },\n  async mounted() {\n    await loadYmap();\n  },\n};\n</script>\n\n<style scoped>\n</style>\n"]}]}